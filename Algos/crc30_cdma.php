<?php
//CRC-30 CDMA
//Author: domasz
//Version: 0.1 (2022-11-17)
//Licence: MIT

require_once 'HasherBase.php';


class Hashercrc30_cdma extends HasherBase
{
	protected $FHash;

	protected $Table = array(
	0x00000000, 0x2030B9C7, 0x2051CA49, 0x0061738E, 0x20932D55, 0x00A39492, 0x00C2E71C, 0x20F25EDB, 
	0x2116E36D, 0x01265AAA, 0x01472924, 0x217790E3, 0x0185CE38, 0x21B577FF, 0x21D40471, 0x01E4BDB6, 
	0x221D7F1D, 0x022DC6DA, 0x024CB554, 0x227C0C93, 0x028E5248, 0x22BEEB8F, 0x22DF9801, 0x02EF21C6, 
	0x030B9C70, 0x233B25B7, 0x235A5639, 0x036AEFFE, 0x2398B125, 0x03A808E2, 0x03C97B6C, 0x23F9C2AB, 
	0x240A47FD, 0x043AFE3A, 0x045B8DB4, 0x246B3473, 0x04996AA8, 0x24A9D36F, 0x24C8A0E1, 0x04F81926, 
	0x051CA490, 0x252C1D57, 0x254D6ED9, 0x057DD71E, 0x258F89C5, 0x05BF3002, 0x05DE438C, 0x25EEFA4B, 
	0x061738E0, 0x26278127, 0x2646F2A9, 0x06764B6E, 0x268415B5, 0x06B4AC72, 0x06D5DFFC, 0x26E5663B, 
	0x2701DB8D, 0x0731624A, 0x075011C4, 0x2760A803, 0x0792F6D8, 0x27A24F1F, 0x27C33C91, 0x07F38556, 
	0x2824363D, 0x08148FFA, 0x0875FC74, 0x284545B3, 0x08B71B68, 0x2887A2AF, 0x28E6D121, 0x08D668E6, 
	0x0932D550, 0x29026C97, 0x29631F19, 0x0953A6DE, 0x29A1F805, 0x099141C2, 0x09F0324C, 0x29C08B8B, 
	0x0A394920, 0x2A09F0E7, 0x2A688369, 0x0A583AAE, 0x2AAA6475, 0x0A9ADDB2, 0x0AFBAE3C, 0x2ACB17FB, 
	0x2B2FAA4D, 0x0B1F138A, 0x0B7E6004, 0x2B4ED9C3, 0x0BBC8718, 0x2B8C3EDF, 0x2BED4D51, 0x0BDDF496, 
	0x0C2E71C0, 0x2C1EC807, 0x2C7FBB89, 0x0C4F024E, 0x2CBD5C95, 0x0C8DE552, 0x0CEC96DC, 0x2CDC2F1B, 
	0x2D3892AD, 0x0D082B6A, 0x0D6958E4, 0x2D59E123, 0x0DABBFF8, 0x2D9B063F, 0x2DFA75B1, 0x0DCACC76, 
	0x2E330EDD, 0x0E03B71A, 0x0E62C494, 0x2E527D53, 0x0EA02388, 0x2E909A4F, 0x2EF1E9C1, 0x0EC15006, 
	0x0F25EDB0, 0x2F155477, 0x2F7427F9, 0x0F449E3E, 0x2FB6C0E5, 0x0F867922, 0x0FE70AAC, 0x2FD7B36B, 
	0x3078D5BD, 0x10486C7A, 0x10291FF4, 0x3019A633, 0x10EBF8E8, 0x30DB412F, 0x30BA32A1, 0x108A8B66, 
	0x116E36D0, 0x315E8F17, 0x313FFC99, 0x110F455E, 0x31FD1B85, 0x11CDA242, 0x11ACD1CC, 0x319C680B, 
	0x1265AAA0, 0x32551367, 0x323460E9, 0x1204D92E, 0x32F687F5, 0x12C63E32, 0x12A74DBC, 0x3297F47B, 
	0x337349CD, 0x1343F00A, 0x13228384, 0x33123A43, 0x13E06498, 0x33D0DD5F, 0x33B1AED1, 0x13811716, 
	0x14729240, 0x34422B87, 0x34235809, 0x1413E1CE, 0x34E1BF15, 0x14D106D2, 0x14B0755C, 0x3480CC9B, 
	0x3564712D, 0x1554C8EA, 0x1535BB64, 0x350502A3, 0x15F75C78, 0x35C7E5BF, 0x35A69631, 0x15962FF6, 
	0x366FED5D, 0x165F549A, 0x163E2714, 0x360E9ED3, 0x16FCC008, 0x36CC79CF, 0x36AD0A41, 0x169DB386, 
	0x17790E30, 0x3749B7F7, 0x3728C479, 0x17187DBE, 0x37EA2365, 0x17DA9AA2, 0x17BBE92C, 0x378B50EB, 
	0x185CE380, 0x386C5A47, 0x380D29C9, 0x183D900E, 0x38CFCED5, 0x18FF7712, 0x189E049C, 0x38AEBD5B, 
	0x394A00ED, 0x197AB92A, 0x191BCAA4, 0x392B7363, 0x19D92DB8, 0x39E9947F, 0x3988E7F1, 0x19B85E36, 
	0x3A419C9D, 0x1A71255A, 0x1A1056D4, 0x3A20EF13, 0x1AD2B1C8, 0x3AE2080F, 0x3A837B81, 0x1AB3C246, 
	0x1B577FF0, 0x3B67C637, 0x3B06B5B9, 0x1B360C7E, 0x3BC452A5, 0x1BF4EB62, 0x1B9598EC, 0x3BA5212B, 
	0x3C56A47D, 0x1C661DBA, 0x1C076E34, 0x3C37D7F3, 0x1CC58928, 0x3CF530EF, 0x3C944361, 0x1CA4FAA6, 
	0x1D404710, 0x3D70FED7, 0x3D118D59, 0x1D21349E, 0x3DD36A45, 0x1DE3D382, 0x1D82A00C, 0x3DB219CB, 
	0x1E4BDB60, 0x3E7B62A7, 0x3E1A1129, 0x1E2AA8EE, 0x3ED8F635, 0x1EE84FF2, 0x1E893C7C, 0x3EB985BB, 
	0x3F5D380D, 0x1F6D81CA, 0x1F0CF244, 0x3F3C4B83, 0x1FCE1558, 0x3FFEAC9F, 0x3F9FDF11, 0x1FAF66D6
	);
	
	public function __construct()
	{	
		$this->FHash = 0x3fffffff;
		$this->Check = '04C34ABF';
	}
	
	public function Update($Msg, $Length)	
	{
		for ($i=0; $i<$Length; $i++)
		{
			$this->FHash = ($this->FHash << 8) ^ $this->Table[(ord($Msg[$i]) ^ ($this->FHash >> 22)) & 0xFF];
		}   
	}
	
	public function Finish()
	{
		$this->FHash = $this->FHash & 0x3fffffff;
		$this->FHash = $this->FHash ^ 0x3fffffff;
		return sprintf('%08X', $this->FHash);
	}
}


$HasherList->RegisterHasher('CRC-30 CDMA', 'Hashercrc30_cdma');


