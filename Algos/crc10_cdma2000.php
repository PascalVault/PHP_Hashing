<?php
//CRC-10 cdma2000
//Author: domasz
//Version: 0.1 (2022-11-17)
//Licence: MIT

require_once 'HasherBase.php';

class HasherCRC10_cdma2000 extends HasherBase
{
	protected $FHash;

	protected $Table = array(
	0x0000, 0x03D9, 0x006B, 0x03B2, 0x00D6, 0x030F, 0x00BD, 0x0364, 
	0x01AC, 0x0275, 0x01C7, 0x021E, 0x017A, 0x02A3, 0x0111, 0x02C8, 
	0x0358, 0x0081, 0x0333, 0x00EA, 0x038E, 0x0057, 0x03E5, 0x003C, 
	0x02F4, 0x012D, 0x029F, 0x0146, 0x0222, 0x01FB, 0x0249, 0x0190, 
	0x0169, 0x02B0, 0x0102, 0x02DB, 0x01BF, 0x0266, 0x01D4, 0x020D, 
	0x00C5, 0x031C, 0x00AE, 0x0377, 0x0013, 0x03CA, 0x0078, 0x03A1, 
	0x0231, 0x01E8, 0x025A, 0x0183, 0x02E7, 0x013E, 0x028C, 0x0155, 
	0x039D, 0x0044, 0x03F6, 0x002F, 0x034B, 0x0092, 0x0320, 0x00F9, 
	0x02D2, 0x010B, 0x02B9, 0x0160, 0x0204, 0x01DD, 0x026F, 0x01B6, 
	0x037E, 0x00A7, 0x0315, 0x00CC, 0x03A8, 0x0071, 0x03C3, 0x001A, 
	0x018A, 0x0253, 0x01E1, 0x0238, 0x015C, 0x0285, 0x0137, 0x02EE, 
	0x0026, 0x03FF, 0x004D, 0x0394, 0x00F0, 0x0329, 0x009B, 0x0342, 
	0x03BB, 0x0062, 0x03D0, 0x0009, 0x036D, 0x00B4, 0x0306, 0x00DF, 
	0x0217, 0x01CE, 0x027C, 0x01A5, 0x02C1, 0x0118, 0x02AA, 0x0173, 
	0x00E3, 0x033A, 0x0088, 0x0351, 0x0035, 0x03EC, 0x005E, 0x0387, 
	0x014F, 0x0296, 0x0124, 0x02FD, 0x0199, 0x0240, 0x01F2, 0x022B, 
	0x027D, 0x01A4, 0x0216, 0x01CF, 0x02AB, 0x0172, 0x02C0, 0x0119, 
	0x03D1, 0x0008, 0x03BA, 0x0063, 0x0307, 0x00DE, 0x036C, 0x00B5, 
	0x0125, 0x02FC, 0x014E, 0x0297, 0x01F3, 0x022A, 0x0198, 0x0241, 
	0x0089, 0x0350, 0x00E2, 0x033B, 0x005F, 0x0386, 0x0034, 0x03ED, 
	0x0314, 0x00CD, 0x037F, 0x00A6, 0x03C2, 0x001B, 0x03A9, 0x0070, 
	0x02B8, 0x0161, 0x02D3, 0x010A, 0x026E, 0x01B7, 0x0205, 0x01DC, 
	0x004C, 0x0395, 0x0027, 0x03FE, 0x009A, 0x0343, 0x00F1, 0x0328, 
	0x01E0, 0x0239, 0x018B, 0x0252, 0x0136, 0x02EF, 0x015D, 0x0284, 
	0x00AF, 0x0376, 0x00C4, 0x031D, 0x0079, 0x03A0, 0x0012, 0x03CB, 
	0x0103, 0x02DA, 0x0168, 0x02B1, 0x01D5, 0x020C, 0x01BE, 0x0267, 
	0x03F7, 0x002E, 0x039C, 0x0045, 0x0321, 0x00F8, 0x034A, 0x0093, 
	0x025B, 0x0182, 0x0230, 0x01E9, 0x028D, 0x0154, 0x02E6, 0x013F, 
	0x01C6, 0x021F, 0x01AD, 0x0274, 0x0110, 0x02C9, 0x017B, 0x02A2, 
	0x006A, 0x03B3, 0x0001, 0x03D8, 0x00BC, 0x0365, 0x00D7, 0x030E, 
	0x029E, 0x0147, 0x02F5, 0x012C, 0x0248, 0x0191, 0x0223, 0x01FA, 
	0x0332, 0x00EB, 0x0359, 0x0080, 0x03E4, 0x003D, 0x038F, 0x0056
	);

	public function __construct()
	{	
		$this->FHash = 0x3FF;
		$this->Check = '233';
	}
	
	public function Update($Msg, $Length)	
	{
		for ($i=0; $i<$Length; $i++)
		{
			$this->FHash = ($this->FHash << 8) ^ $this->Table[(ord($Msg[$i]) ^ ($this->FHash >> 2)) & 0xFF];	
		}   
	}
	
	public function Finish()
	{
		$this->FHash = $this->FHash & 0x3FF;
		return sprintf('%03X', $this->FHash);
	}
}

$HasherList->RegisterHasher('CRC-10 cdma2000', 'HasherCRC10_cdma2000');


