<?php
//CRC-31 PHILIPS
//Author: domasz
//Version: 0.1 (2022-11-17)
//Licence: MIT

require_once 'HasherBase.php';

class Hashercrc31_philips extends HasherBase
{
	protected $FHash;

	protected $Table = array(
	0x00000000, 0x04C11DB7, 0x09823B6E, 0x0D4326D9, 0x130476DC, 0x17C56B6B, 0x1A864DB2, 0x1E475005,
	0x2608EDB8, 0x22C9F00F, 0x2F8AD6D6, 0x2B4BCB61, 0x350C9B64, 0x31CD86D3, 0x3C8EA00A, 0x384FBDBD,
	0x4C11DB70, 0x48D0C6C7, 0x4593E01E, 0x4152FDA9, 0x5F15ADAC, 0x5BD4B01B, 0x569796C2, 0x52568B75,
	0x6A1936C8, 0x6ED82B7F, 0x639B0DA6, 0x675A1011, 0x791D4014, 0x7DDC5DA3, 0x709F7B7A, 0x745E66CD,
	0x1CE2AB57, 0x1823B6E0, 0x15609039, 0x11A18D8E, 0x0FE6DD8B, 0x0B27C03C, 0x0664E6E5, 0x02A5FB52,
	0x3AEA46EF, 0x3E2B5B58, 0x33687D81, 0x37A96036, 0x29EE3033, 0x2D2F2D84, 0x206C0B5D, 0x24AD16EA,
	0x50F37027, 0x54326D90, 0x59714B49, 0x5DB056FE, 0x43F706FB, 0x47361B4C, 0x4A753D95, 0x4EB42022,
	0x76FB9D9F, 0x723A8028, 0x7F79A6F1, 0x7BB8BB46, 0x65FFEB43, 0x613EF6F4, 0x6C7DD02D, 0x68BCCD9A,
	0x39C556AE, 0x3D044B19, 0x30476DC0, 0x34867077, 0x2AC12072, 0x2E003DC5, 0x23431B1C, 0x278206AB,
	0x1FCDBB16, 0x1B0CA6A1, 0x164F8078, 0x128E9DCF, 0x0CC9CDCA, 0x0808D07D, 0x054BF6A4, 0x018AEB13,
	0x75D48DDE, 0x71159069, 0x7C56B6B0, 0x7897AB07, 0x66D0FB02, 0x6211E6B5, 0x6F52C06C, 0x6B93DDDB,
	0x53DC6066, 0x571D7DD1, 0x5A5E5B08, 0x5E9F46BF, 0x40D816BA, 0x44190B0D, 0x495A2DD4, 0x4D9B3063,
	0x2527FDF9, 0x21E6E04E, 0x2CA5C697, 0x2864DB20, 0x36238B25, 0x32E29692, 0x3FA1B04B, 0x3B60ADFC,
	0x032F1041, 0x07EE0DF6, 0x0AAD2B2F, 0x0E6C3698, 0x102B669D, 0x14EA7B2A, 0x19A95DF3, 0x1D684044,
	0x69362689, 0x6DF73B3E, 0x60B41DE7, 0x64750050, 0x7A325055, 0x7EF34DE2, 0x73B06B3B, 0x7771768C,
	0x4F3ECB31, 0x4BFFD686, 0x46BCF05F, 0x427DEDE8, 0x5C3ABDED, 0x58FBA05A, 0x55B88683, 0x51799B34,
	0x738AAD5C, 0x774BB0EB, 0x7A089632, 0x7EC98B85, 0x608EDB80, 0x644FC637, 0x690CE0EE, 0x6DCDFD59,
	0x558240E4, 0x51435D53, 0x5C007B8A, 0x58C1663D, 0x46863638, 0x42472B8F, 0x4F040D56, 0x4BC510E1,
	0x3F9B762C, 0x3B5A6B9B, 0x36194D42, 0x32D850F5, 0x2C9F00F0, 0x285E1D47, 0x251D3B9E, 0x21DC2629,
	0x19939B94, 0x1D528623, 0x1011A0FA, 0x14D0BD4D, 0x0A97ED48, 0x0E56F0FF, 0x0315D626, 0x07D4CB91,
	0x6F68060B, 0x6BA91BBC, 0x66EA3D65, 0x622B20D2, 0x7C6C70D7, 0x78AD6D60, 0x75EE4BB9, 0x712F560E,
	0x4960EBB3, 0x4DA1F604, 0x40E2D0DD, 0x4423CD6A, 0x5A649D6F, 0x5EA580D8, 0x53E6A601, 0x5727BBB6,
	0x2379DD7B, 0x27B8C0CC, 0x2AFBE615, 0x2E3AFBA2, 0x307DABA7, 0x34BCB610, 0x39FF90C9, 0x3D3E8D7E,
	0x057130C3, 0x01B02D74, 0x0CF30BAD, 0x0832161A, 0x1675461F, 0x12B45BA8, 0x1FF77D71, 0x1B3660C6,
	0x4A4FFBF2, 0x4E8EE645, 0x43CDC09C, 0x470CDD2B, 0x594B8D2E, 0x5D8A9099, 0x50C9B640, 0x5408ABF7,
	0x6C47164A, 0x68860BFD, 0x65C52D24, 0x61043093, 0x7F436096, 0x7B827D21, 0x76C15BF8, 0x7200464F,
	0x065E2082, 0x029F3D35, 0x0FDC1BEC, 0x0B1D065B, 0x155A565E, 0x119B4BE9, 0x1CD86D30, 0x18197087,
	0x2056CD3A, 0x2497D08D, 0x29D4F654, 0x2D15EBE3, 0x3352BBE6, 0x3793A651, 0x3AD08088, 0x3E119D3F,
	0x56AD50A5, 0x526C4D12, 0x5F2F6BCB, 0x5BEE767C, 0x45A92679, 0x41683BCE, 0x4C2B1D17, 0x48EA00A0,
	0x70A5BD1D, 0x7464A0AA, 0x79278673, 0x7DE69BC4, 0x63A1CBC1, 0x6760D676, 0x6A23F0AF, 0x6EE2ED18,
	0x1ABC8BD5, 0x1E7D9662, 0x133EB0BB, 0x17FFAD0C, 0x09B8FD09, 0x0D79E0BE, 0x003AC667, 0x04FBDBD0,
	0x3CB4666D, 0x38757BDA, 0x35365D03, 0x31F740B4, 0x2FB010B1, 0x2B710D06, 0x26322BDF, 0x22F33668
	);
	
	public function __construct()
	{	
		$this->FHash = 0x7fffffff;
		$this->Check = '0CE9E46C';
	}
	
	public function Update($Msg, $Length)	
	{
		for ($i=0; $i<$Length; $i++)
		{
			$this->FHash = ($this->FHash << 8) ^ $this->Table[(ord($Msg[$i]) ^ ($this->FHash >> 23)) & 0xFF];
		}   
	}
	
	public function Finish()
	{
		$this->FHash = $this->FHash & 0x7fffffff;
		$this->FHash = $this->FHash ^ 0x7fffffff;
		return sprintf('%08X', $this->FHash);
	}
}

$HasherList->RegisterHasher('CRC-31 PHILIPS', 'Hashercrc31_philips');


